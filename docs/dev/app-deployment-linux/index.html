<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="The Ramses comprehensive documentation">
    <meta name="author" content="Nicolas Dufresne and contributors">
    <link rel="canonical" href="https://dev.rxlab.io/app-deployment-linux/">
    <link rel="shortcut icon" href="../img/favicon.ico">

    
    <title>Deploy apps for Linux - RxOT Dev Guide</title>
    

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/v4-shims.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hack-font@3.3.0/build/web/hack.min.css">
    <link href='//rsms.me/inter/inter.css' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="../css/base.min.css" rel="stylesheet">
    <link href="../css/cinder.min.css" rel="stylesheet">

    
        
        <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/styles/zenburn.min.css">
        
    
    <link href="../style.css" rel="stylesheet">
    <link href="../video.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
        <![endif]-->

    

     
</head>

<body>

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->

            
              <a class="navbar-brand" href="..">RxOT Dev Guide</a>
            
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="..">RxOT dev guide</a>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">RxLab <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../urls/">URLs!</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Dev <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li class="active">
    <a href="./">Deploy apps for Linux</a>
</li>

                        
                            
<li >
    <a href="../app-deployment-mac/">Deploy apps for Mac OS</a>
</li>

                        
                            
<li >
    <a href="../git/">Git tips</a>
</li>

                        
                            
<li >
    <a href="../software-versionning/">Semantic versionning</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contrib. guides <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../duik-release-process/">Duik for Ae release process</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">... <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../index.html">All the RxLab documents</a>
</li>

                        
                            
<li >
    <a href="../../contribute.html">Contribute to the doc</a>
</li>

                        
                            
<li >
    <a href="https://rxlab.info">Contact</a>
</li>

                        
                            
<li >
    <a href="https://donate.rxlab.info">Donate</a>
</li>

                        
                        </ul>
                    </li>
                
                
                </ul>

            <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                            <i class="fas fa-search"></i> Search
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../urls/">
                            <i class="fas fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="next" href="../app-deployment-mac/">
                            Next <i class="fas fa-arrow-right"></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/RxLaboratory/RxDocs/edit/master/src-dev/docs/app-deployment-linux.md"><i class="fab fa-github"></i> Edit on GitHub</a>
                    </li>
            </ul>
        </div>
    </div>
</div>

    <div class="container">
        
        
        <div class="col-md-3"><div id="side-menu">
    <div class="bs-sidebar hidden-print  affix well collapsible" role="complementary">
        <!-- Main navigation -->
        <ul class="nav bs-sidenav">
        
        
            <li >
                <a href="../../.">RxOT dev guide</a>
            </li>
        
        
        
            <li class="first-level">
                <button  type="button" class="collapse-button ">RxLab</button>
                <ul class="collapsible-content ">
                    
                        
                        <li class="second-level "><a href="../urls/">URLs!</a></li>
                        
                    
                </ul>
            </li>
        
        
        
            <li class="first-level">
                <button  type="button" class="collapse-button active-collapse-button">Dev</button>
                <ul class="collapsible-content collapsible-content-active">
                    
                        
                        <li class="second-level active"><a href="./">Deploy apps for Linux</a></li>
                        
                    
                        
                        <li class="second-level "><a href="../app-deployment-mac/">Deploy apps for Mac OS</a></li>
                        
                    
                        
                        <li class="second-level "><a href="../git/">Git tips</a></li>
                        
                    
                        
                        <li class="second-level "><a href="../software-versionning/">Semantic versionning</a></li>
                        
                    
                </ul>
            </li>
        
        
        
            <li class="first-level">
                <button  type="button" class="collapse-button ">Contrib. guides</button>
                <ul class="collapsible-content ">
                    
                        
                        <li class="second-level "><a href="../duik-release-process/">Duik for Ae release process</a></li>
                        
                    
                </ul>
            </li>
        
        
        
            <li class="first-level">
                <button  type="button" class="collapse-button ">...</button>
                <ul class="collapsible-content ">
                    
                        
                        <li class="second-level "><a href="../../index.html">All the RxLab documents</a></li>
                        
                    
                        
                        <li class="second-level "><a href="../../contribute.html">Contribute to the doc</a></li>
                        
                    
                        
                        <li class="second-level "><a href="https://rxlab.info">Contact</a></li>
                        
                    
                        
                        <li class="second-level "><a href="https://donate.rxlab.info">Donate</a></li>
                        
                    
                </ul>
            </li>
        
        
        </ul>
    </div>
    <div class="bs-sidebar hidden-print affix well" role="complementary">
        <ul class="nav bs-sidenav">
            <li class="first-level active"><a href="#deploy-linux-applications">Deploy linux applications</a></li>
                <li class="second-level"><a href="#install-a-virtual-machine-to-build-and-test-on-older-distros">Install a virtual machine to build and test on older distros</a></li>
                    
                <li class="second-level"><a href="#deb-packages">Deb packages</a></li>
                    
                    <li class="third-level"><a href="#1-create-the-file-and-folder-structure">1. Create the file and folder structure</a></li>
                    <li class="third-level"><a href="#2-edit-the-usrshareapplicationsdesktop-file">2. Edit the usr/share/applications/*.desktop file.</a></li>
                    <li class="third-level"><a href="#3-edit-the-usrsharedocappnamecopyright-file">3. Edit the usr/share/doc/AppName/copyright file</a></li>
                    <li class="third-level"><a href="#4-edit-the-debiancontrol-file">4. Edit the DEBIAN/control file.</a></li>
                    <li class="third-level"><a href="#5-generate-md5sums">5. Generate md5sums</a></li>
                    <li class="third-level"><a href="#6-build-deb-package">6. Build deb package</a></li>
                <li class="second-level"><a href="#appimage">AppImage</a></li>
                    
                    <li class="third-level"><a href="#1-create-the-file-and-folder-structure_1">1. Create the file and folder structure</a></li>
                    <li class="third-level"><a href="#2-build-using-the-linuxdeployqt-utility">2. Build using the linuxdeployqt utility</a></li>
        </ul>
    </div>
    <div class="footer-meta"></div>
</div></div>
        <div class="col-md-9" role="main">

<h1 id="deploy-linux-applications">Deploy linux applications</h1>
<p>TODO:
virtual box for unbuntu 18.04
-&gt; add user to vboxsf group to access shared folders <code>sudo adduser $USER vboxsf</code>
-&gt; install C++ ccompiler <code>sudo apt install g++</code>
-&gt; install xcb platform needed by qt: <code>sudo apt install libxcb-xinerama0</code>
-&gt; install libgl-dev needed by qt: <code>sudo apt install libgl-dev</code>
-&gt; install Qt (5.9.9)</p>
<p>At RxLaboratory, we deploy linux applications in two formats: <em>Deb</em> packages for <em>Debian/Ubuntu</em>, and <em>AppImage</em> files for other distributions.</p>
<p>Let&rsquo;s assume the application has already been built and consists in at least one executable binary. This is the procedure to follow to deploy the application.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>To ensure a vast compatibility, apps have to be built and deployed at least on <strong><em>Ubuntu 18.04 Bionic Beaver</em></strong> <strong>and not on any other more recent version</strong>.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If the desktop file has issues, the Deb and AppImage won&rsquo;t be built, and for the Deb, dpkg will not warn about the issue. It may be easier to start with the AppImage to make sure the desktop file works, or have some info about what may be wrong.</p>
</div>
<h2 id="install-a-virtual-machine-to-build-and-test-on-older-distros">Install a virtual machine to build and test on older distros</h2>
<ul>
<li>Download and install <a href="https://www.virtualbox.org/wiki/Linux_Downloads"><em>Virtual Box</em></a><br />
    Note that it may be easier and better to follow the procedure to add their package repo.</li>
<li>Download and install <a href="https://ubuntu.com/download/alternative-downloads"><em>Ubuntu</em></a> (or any other distro) on a VM.<br />
    Next steps are inside the VM.</li>
<li>Add the user to the vboxsf group (needed to access shared folders): <code>sudo adduser $USER vboxsf</code></li>
</ul>
<p>If this machine is used for building applications</p>
<ul>
<li>Install a c++ compiler: <code>sudo apt install g++</code></li>
<li>Install libxcb needed by Qt: <code>sudo apt install libxcb-xinerama0</code></li>
<li>Install libgl-dev needed by qt: <code>sudo apt install libgl-dev</code></li>
<li>Install <a href="http://qt.io">Qt</a> (<em>5.9.9</em> on Ubuntu 18.04 for best compatibility)</li>
</ul>
<h2 id="deb-packages">Deb packages</h2>
<p>When updating an existing package, you can just update the changelog and jump to the 4th section.</p>
<h3 id="1-create-the-file-and-folder-structure">1. Create the file and folder structure</h3>
<p>Example:</p>
<pre><code>AppName-Deb
|- DEBIAN
   control
|- usr
  |- bin
     AppName
   |- share
      |- applications
         AppName.desktop
      |- doc
         |- AppName
            changelog
            copyright
      |- icons
         |- hicolor
            |- 24x24
               |- apps
                  AppName.png
            |- 32x32
               |- apps
                  AppName.png
            |- 48x48
               |- apps
                  AppName.png
            |- 128x128
               |- apps
                  AppName.png
            |- 256x256
               |- apps
                  AppName.png
</code></pre>
<p>An empty folder structure is available in <code>RAINBOX/ADMIN/DEV/00 - Docs/LINUX/Build Deb Package/Example-Package-Folder</code></p>
<h3 id="2-edit-the-usrshareapplicationsdesktop-file">2. Edit the <code>usr/share/applications/*.desktop</code> file.</h3>
<p>Example:</p>
<pre><code>[Desktop Entry]
Type=Application
Name=AppName
GenericName=Media Encoder
Comment=The Duduf Media Encoder, a fast, easy-to-use, versatile media encoder.
Exec=AppName
Icon=AppName
MimeType=video/*;audio/*;image/*;
Categories=AudioVideo;Audio;Video;AudioVideoEditing;
</code></pre>
<p><a href="https://specifications.freedesktop.org/menu-spec/latest/apa.html">The list of Main Categories is available here</a>, which can be completed by <a href="https://specifications.freedesktop.org/menu-spec/latest/apas02.html">the list of Additional Categories</a>.</p>
<p>The mime type is optional. A <a href="https://www.lifewire.com/file-extensions-and-mime-types-3469109">list of mime types is available here</a>.</p>
<h3 id="3-edit-the-usrsharedocappnamecopyright-file">3. Edit the <code>usr/share/doc/AppName/copyright</code> file</h3>
<p>Example:</p>
<pre><code>Format: https://www.debian.org/doc/packaging-manuals/copyright-format/1.0/
Upstream-Name: DuME The Duduf Media Encoder
Source: https://github.com/Rainbox-dev/DuME

Files: *
Copyright: 2017-2020 Nicolas Dufresne
License: GPL-3+
 This program is free software; you can redistribute them and/or modify them under the terms of the GNU General Public License as published by the Free Software Foundation; either version 3 of the License, or (at your option) any later version.
 .
 This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY
 .
 On Debian systems, the full text of the GNU General Public License version 2 can be found in the file `/usr/share/common-licenses/GPL-2'.
</code></pre>
<h3 id="4-edit-the-debiancontrol-file">4. Edit the <code>DEBIAN/control</code> file.</h3>
<p>Example:</p>
<pre><code>Package: DuME
Version: 0.1.2
Architecture: amd64
Essential: no
Section: video
Priority: optional
Depends: ffmpeg (&gt;=4.0), qt5-default
Maintainer: Duduf
Installed-Size: 6900
Description: A fast, easy-to-use and versatile media encoder.
Homepage: https://rainboxlab.org/tools/dume/
</code></pre>
<p>The <code>section</code> can be one of: admin, cli-mono, comm, database, debug, devel, doc, editors, education, electronics, embedded, fonts, games, gnome, gnu-r, gnustep, graphics, hamradio, haskell, httpd, interpreters, introspection, java, javascript, kde, kernel, libdevel, libs, lisp, localization, mail, math, metapackages, misc, net, news, ocaml, oldlibs, otherosfs, perl, php, python, ruby, rust, science, shells, sound, tasks, tex, text, utils, vcs, video, web, x11, xfce, zope.<br />
The additional section debian-installer contains special packages used by the installer and is not used for normal Debian packages.</p>
<p><code>Installed-Size</code> should be the size of the <code>usr</code> folder in the package, in kB. The disk space is given as the integer value of the estimated installed size in bytes, divided by 1024 and rounded up.</p>
<p>See <a href="https://www.debian.org/doc/debian-policy/ch-controlfields.html">this page on debian.org</a> for more details.</p>
<h3 id="5-generate-md5sums">5. Generate md5sums</h3>
<p>Run this command from the root of the package folder:</p>
<pre><code class="language-bash">find . -type f ! -regex '.*.hg.*' ! -regex '.*?debian-binary.*' ! -regex '.*?DEBIAN.*' -printf '%P ' | xargs md5sum &gt; DEBIAN/md5sums
</code></pre>
<h3 id="6-build-deb-package">6. Build deb package</h3>
<p>Run this command:</p>
<pre><code class="language-bash">chmod 755 folder/DEBIAN
dpkg -b folder app-0.0.0-amd64.deb
</code></pre>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The <code>chmod</code> command won&rsquo;t work on NTFS file systems. Therefore, the <em>Deb</em> package can only be built on a linux file system.</p>
<p>Here is a bash script to automate the last two steps:</p>
</div>
<pre><code class="language-sh">#!/bin/bash

# usage: ./deploy-deb AppName
# The deb folder must be named &quot;AppName-Deb&quot; and located next to the script

# generate md5sums
cd &quot;$1-Deb&quot;
find . -type f ! -regex '.*.hg.*' ! -regex '.*?debian-binary.*' ! -regex '.*?DEBIAN.*' -printf '%P ' | xargs md5sum &gt; DEBIAN/md5sums

# chmod 
chmod 755 DEBIAN
# build
cd ..
dpkg -b &quot;$1-Deb&quot; &quot;$1.deb&quot;
</code></pre>
<h2 id="appimage">AppImage</h2>
<h3 id="1-create-the-file-and-folder-structure_1">1. Create the file and folder structure</h3>
<p>This is the same as for Deb packages, except the DEBIAN control folder is not needed.</p>
<h3 id="2-build-using-the-linuxdeployqt-utility">2. Build using the <code>linuxdeployqt</code> utility</h3>
<p>Run this command using a <a href="https://github.com/probonopd/linuxdeployqt/releases"><code>linuxdeployqt</code></a> appImage. Replace <code>desktopFile</code> with the path to the desktop file inside the Deb package.</p>
<pre><code class="language-bash">./linuxdeployqt-6-x86_64.AppImage desktopFile -unsupported-allow-new-glibc -always-overwrite -appimage -no-translations -qmake=/home/duduf/Qt/5.9.9/gcc_64/bin/qmake -extra-plugins=iconengines,platformthemes/libqgtk3.so
</code></pre>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Make sure the application has been built with a version of Qt with an available <code>qmake</code> bin, and it&rsquo;s the correct one in the command above.</p>
</div></div>
        
            <div class="nav-footer">
            <ul>
                <li class="nav-footer-prev">
                    <a rel="prev" href="../urls/">
                        <i class="fas fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li class="nav-footer-next">
                    <a rel="next" href="../app-deployment-mac/">
                        Next <i class="fas fa-arrow-right"></i>
                    </a>
                </li>
            </ul>
            </div>
        
    </div>

    
      <footer class="col-md-12 text-center">
          
<div></div>

      </footer>
    
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="../js/bootstrap-3.0.3.min.js"></script>

    
    <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/highlight.min.js"></script>
        
    <script>hljs.initHighlightingOnLoad();</script>
    

    <script>var base_url = ".."</script>
    
    <script src="../js/base.js"></script>
    <script src="../video.js"></script>
    <script src="../meta.js"></script>
    <script src="../collapser.js"></script>
    <script src="../search/main.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">
                    <span aria-hidden="true">&times;</span>
                    <span class="sr-only">Close</span>
                </button>
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>
    </body>

</html>
